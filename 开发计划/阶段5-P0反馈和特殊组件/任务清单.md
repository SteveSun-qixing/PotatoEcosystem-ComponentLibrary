# 阶段5: P0反馈和特殊组件 - 任务清单

**阶段目标**: 实现反馈组件和生态集成组件  
**预计任务数**: 14  
**依赖**: 阶段3完成  
**状态**: 待开始

---

## 任务列表

### 任务5.1: 实现 Modal 对话框组件

**描述**: 实现模态对话框组件

**Props接口**:
```typescript
interface ModalProps {
  modelValue?: boolean;
  title?: string;
  width?: number | string;
  top?: number | string;
  closable?: boolean;
  maskClosable?: boolean;
  keyboard?: boolean;
  centered?: boolean;
  destroyOnClose?: boolean;
  confirmLoading?: boolean;
  okText?: string;
  cancelText?: string;
  okType?: 'default' | 'primary' | 'dashed' | 'danger';
  footer?: VNode | null;
  zIndex?: number;
}

interface ModalEmits {
  'update:modelValue': [visible: boolean];
  ok: [];
  cancel: [];
  afterOpen: [];
  afterClose: [];
}

interface ModalSlots {
  default?: () => VNode;
  title?: () => VNode;
  footer?: () => VNode;
}

// 静态方法
interface ModalStatic {
  confirm: (options: ModalConfirmOptions) => ModalInstance;
  info: (options: ModalOptions) => ModalInstance;
  success: (options: ModalOptions) => ModalInstance;
  error: (options: ModalOptions) => ModalInstance;
  warning: (options: ModalOptions) => ModalInstance;
  destroyAll: () => void;
}
```

**功能要求**:
- 支持 v-model 控制显示
- 支持确认加载状态
- 支持 ESC 键关闭
- 支持点击遮罩关闭
- 阻止背景滚动
- Portal 到 body
- 静态确认方法

**样式接口点**:
```
.chips-modal                  - 对话框容器
.chips-modal-root             - 根容器
.chips-modal-mask             - 遮罩层
.chips-modal-wrap             - 包装层
.chips-modal__content         - 内容容器
.chips-modal__header          - 头部
.chips-modal__title           - 标题
.chips-modal__close           - 关闭按钮
.chips-modal__body            - 主体
.chips-modal__footer          - 底部
.chips-modal--centered        - 居中
.chips-modal-confirm          - 确认对话框
.chips-modal-confirm__icon    - 确认图标
.chips-modal-confirm__content - 确认内容
```

**验收标准**:
- [ ] 基础 Modal 组件完成
- [ ] 静态方法实现完成
- [ ] ESC 和遮罩关闭正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.2: 实现 Message 消息提示组件

**描述**: 实现全局消息提示组件

**API接口**:
```typescript
interface MessageOptions {
  content: string;
  duration?: number;
  type?: 'info' | 'success' | 'warning' | 'error' | 'loading';
  icon?: VNode;
  closable?: boolean;
  onClose?: () => void;
}

interface MessageInstance {
  close: () => void;
}

interface MessageApi {
  open: (options: MessageOptions) => MessageInstance;
  info: (content: string, duration?: number) => MessageInstance;
  success: (content: string, duration?: number) => MessageInstance;
  warning: (content: string, duration?: number) => MessageInstance;
  error: (content: string, duration?: number) => MessageInstance;
  loading: (content: string, duration?: number) => MessageInstance;
  destroy: () => void;
  config: (options: MessageConfig) => void;
}

interface MessageConfig {
  top?: number;
  duration?: number;
  maxCount?: number;
  getContainer?: () => HTMLElement;
}
```

**功能要求**:
- 全局提示
- 多种类型（success、warning、error、info、loading）
- 自动关闭
- 手动关闭
- 最大数量限制
- 自定义容器

**样式接口点**:
```
.chips-message                - 消息容器
.chips-message__notice        - 消息项
.chips-message__content       - 内容
.chips-message__icon          - 图标
.chips-message__close         - 关闭按钮
.chips-message--info
.chips-message--success
.chips-message--warning
.chips-message--error
.chips-message--loading
```

**验收标准**:
- [ ] Message API 实现完成
- [ ] 所有类型正常显示
- [ ] 自动关闭正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.3: 实现 Loading 加载组件

**描述**: 实现加载中状态组件

**Props接口**:
```typescript
interface LoadingProps {
  loading?: boolean;
  tip?: string;
  size?: 'small' | 'default' | 'large';
  indicator?: VNode;
  fullscreen?: boolean;
  delay?: number;
}

interface LoadingSlots {
  default?: () => VNode;
  indicator?: () => VNode;
  tip?: () => VNode;
}

// 指令
interface LoadingDirective {
  // v-loading
}
```

**功能要求**:
- 包裹内容加载
- 全屏加载
- 自定义加载图标
- 延迟显示
- 加载提示文本

**样式接口点**:
```
.chips-loading                - 加载容器
.chips-loading__mask          - 遮罩
.chips-loading__content       - 内容区
.chips-loading__spinner       - 加载图标
.chips-loading__text          - 提示文本
.chips-loading--fullscreen    - 全屏模式
.chips-loading--small
.chips-loading--large
.chips-loading--nested        - 嵌套模式
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 全屏加载正常
- [ ] v-loading 指令实现
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.4: 实现 Text 文本组件

**描述**: 实现文本展示组件

**Props接口**:
```typescript
interface TextProps {
  type?: 'default' | 'primary' | 'secondary' | 'success' | 'warning' | 'danger';
  strong?: boolean;
  italic?: boolean;
  underline?: boolean;
  delete?: boolean;
  code?: boolean;
  mark?: boolean;
  keyboard?: boolean;
  ellipsis?: boolean | { rows?: number; expandable?: boolean };
  copyable?: boolean | { text?: string; onCopy?: () => void };
}

interface TextSlots {
  default?: () => VNode;
}
```

**样式接口点**:
```
.chips-text                   - 文本容器
.chips-text--primary
.chips-text--secondary
.chips-text--success
.chips-text--warning
.chips-text--danger
.chips-text--strong
.chips-text--italic
.chips-text--underline
.chips-text--delete
.chips-text--code
.chips-text--mark
.chips-text--keyboard
.chips-text--ellipsis
.chips-text__copy             - 复制按钮
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 省略功能正常
- [ ] 复制功能正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.5: 实现 Image 图片组件

**描述**: 实现图片展示组件

**Props接口**:
```typescript
interface ImageProps {
  src: string;
  alt?: string;
  width?: number | string;
  height?: number | string;
  fit?: 'contain' | 'cover' | 'fill' | 'none' | 'scale-down';
  lazy?: boolean;
  preview?: boolean | ImagePreviewOptions;
  fallback?: string;
  placeholder?: VNode;
}

interface ImageEmits {
  load: [event: Event];
  error: [event: Event];
}

interface ImagePreviewOptions {
  visible?: boolean;
  src?: string;
  maskClosable?: boolean;
  onVisibleChange?: (visible: boolean) => void;
}
```

**功能要求**:
- 图片显示
- 懒加载
- 预览功能
- 加载失败占位
- 各种适配模式

**样式接口点**:
```
.chips-image                  - 图片容器
.chips-image__img             - 图片元素
.chips-image__placeholder     - 占位符
.chips-image__error           - 错误占位
.chips-image__preview         - 预览容器
.chips-image--loading
.chips-image--error
.chips-image--fit-contain
.chips-image--fit-cover
```

**与基础层集成**:
- 调用 `ImageViewer` 显示预览

**验收标准**:
- [ ] 组件实现完成
- [ ] 懒加载正常
- [ ] 预览功能集成基础层
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.6: 实现 Icon 图标组件

**描述**: 实现图标展示组件

**Props接口**:
```typescript
interface IconProps {
  name?: string;
  size?: number | string;
  color?: string;
  spin?: boolean;
  rotate?: number;
}

interface IconSlots {
  default?: () => VNode;
}
```

**功能要求**:
- 支持图标名称
- 支持自定义图标（slot）
- 旋转动画
- 大小和颜色控制

**样式接口点**:
```
.chips-icon                   - 图标容器
.chips-icon--spin             - 旋转动画
.chips-icon__svg              - SVG 元素
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 图标渲染正常
- [ ] 旋转动画正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.7: 实现 Tag 标签组件

**描述**: 实现标签展示组件

**Props接口**:
```typescript
interface TagProps {
  color?: 'default' | 'success' | 'processing' | 'warning' | 'error' | string;
  closable?: boolean;
  bordered?: boolean;
  size?: 'small' | 'medium' | 'large';
}

interface TagEmits {
  close: [event: Event];
}

interface TagSlots {
  default?: () => VNode;
  icon?: () => VNode;
  closeIcon?: () => VNode;
}
```

**样式接口点**:
```
.chips-tag                    - 标签容器
.chips-tag__icon              - 图标
.chips-tag__content           - 内容
.chips-tag__close             - 关闭按钮
.chips-tag--closable
.chips-tag--bordered
.chips-tag--success
.chips-tag--processing
.chips-tag--warning
.chips-tag--error
.chips-tag--small
.chips-tag--large
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 可关闭功能正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.8: 实现 Tooltip 文字提示组件

**描述**: 实现文字提示气泡组件

**Props接口**:
```typescript
interface TooltipProps {
  content?: string;
  placement?: Placement;
  trigger?: 'hover' | 'click' | 'focus' | 'contextmenu';
  visible?: boolean;
  defaultVisible?: boolean;
  disabled?: boolean;
  mouseEnterDelay?: number;
  mouseLeaveDelay?: number;
  arrowPointAtCenter?: boolean;
  destroyOnHide?: boolean;
  getPopupContainer?: () => HTMLElement;
}

type Placement =
  | 'top' | 'topLeft' | 'topRight'
  | 'bottom' | 'bottomLeft' | 'bottomRight'
  | 'left' | 'leftTop' | 'leftBottom'
  | 'right' | 'rightTop' | 'rightBottom';

interface TooltipEmits {
  'update:visible': [visible: boolean];
  visibleChange: [visible: boolean];
}
```

**功能要求**:
- 多种触发方式
- 12种位置
- 延迟显示/隐藏
- 受控/非受控模式

**样式接口点**:
```
.chips-tooltip                - 提示容器
.chips-tooltip__content       - 内容
.chips-tooltip__arrow         - 箭头
.chips-tooltip--top
.chips-tooltip--bottom
.chips-tooltip--left
.chips-tooltip--right
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 所有位置正常
- [ ] 触发方式正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.9: 实现 CardWrapper 卡片包装器组件

**描述**: 为基础卡片提供通用外层容器

**Props接口**:
```typescript
interface CardWrapperProps {
  cardId?: string;
  cardType?: string;
  theme?: string;
  editable?: boolean;
  loading?: boolean;
  error?: Error | null;
}

interface CardWrapperEmits {
  edit: [];
  retry: [];
}

interface CardWrapperSlots {
  default?: () => VNode;
  header?: () => VNode;
  footer?: () => VNode;
  loading?: () => VNode;
  error?: () => VNode;
}
```

**样式接口点**:
```
.chips-card-wrapper           - 卡片包装容器
.chips-card-wrapper--editable - 可编辑状态
.chips-card-wrapper--loading  - 加载状态
.chips-card-wrapper--error    - 错误状态
.chips-card-wrapper__header   - 头部
.chips-card-wrapper__content  - 内容
.chips-card-wrapper__footer   - 底部
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 各状态正确显示
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.10: 实现 CardHeader 卡片头部组件

**描述**: 卡片的标题栏组件

**Props接口**:
```typescript
interface CardHeaderProps {
  title?: string;
  closable?: boolean;
}

interface CardHeaderEmits {
  close: [];
}

interface CardHeaderSlots {
  default?: () => VNode;
  title?: () => VNode;
  actions?: () => VNode;
}
```

**样式接口点**:
```
.chips-card-header            - 头部容器
.chips-card-header__title     - 标题
.chips-card-header__actions   - 操作区域
.chips-card-header__close     - 关闭按钮
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.11: 实现 CardLoading 卡片加载状态组件

**描述**: 卡片加载中的占位组件

**Props接口**:
```typescript
interface CardLoadingProps {
  tip?: string;
}
```

**样式接口点**:
```
.chips-card-loading           - 加载容器
.chips-card-loading__spinner  - 加载图标
.chips-card-loading__tip      - 提示文本
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.12: 实现 CardError 卡片错误状态组件

**描述**: 卡片加载失败的错误展示

**Props接口**:
```typescript
interface CardErrorProps {
  error?: Error | string;
  retryable?: boolean;
}

interface CardErrorEmits {
  retry: [];
}
```

**样式接口点**:
```
.chips-card-error             - 错误容器
.chips-card-error__icon       - 错误图标
.chips-card-error__message    - 错误信息
.chips-card-error__retry      - 重试按钮
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 重试功能正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务5.13: 实现组件导出配置

**描述**: 配置反馈组件和特殊组件的统一导出

**验收标准**:
- [ ] 所有组件正确导出
- [ ] 类型正确导出

---

### 任务5.14: 阶段验证和提交

**描述**: 完成反馈和特殊组件的验证和提交

**验收标准**:
- [ ] 所有测试通过
- [ ] 组件可正常使用
- [ ] 代码提交完成
- [ ] 阶段总结编写完成

---

## 阶段验收标准

- [ ] Modal 组件完成（含静态方法）
- [ ] Message API 完成
- [ ] Loading 组件完成（含指令）
- [ ] Text/Image/Icon/Tag 组件完成
- [ ] Tooltip 组件完成
- [ ] CardWrapper/CardHeader/CardLoading/CardError 完成
- [ ] 所有组件无样式代码
- [ ] 单元测试覆盖率 ≥80%

---

**更新时间**: 2026-02-01
