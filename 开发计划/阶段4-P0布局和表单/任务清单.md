# 阶段4: P0布局和表单组件 - 任务清单

**阶段目标**: 实现核心布局和表单组件  
**预计任务数**: 10  
**依赖**: 阶段2完成  
**状态**: 待开始

---

## 任务列表

### 任务4.1: 实现 Grid 栅格组件 (Row/Col)

**描述**: 实现响应式栅格布局系统

**Props接口**:
```typescript
// Row
interface RowProps {
  gutter?: number | [number, number] | Partial<Record<Breakpoint, number>>;
  justify?: 'start' | 'end' | 'center' | 'space-around' | 'space-between' | 'space-evenly';
  align?: 'top' | 'middle' | 'bottom' | 'stretch';
  wrap?: boolean;
}

// Col
interface ColProps {
  span?: number;
  offset?: number;
  push?: number;
  pull?: number;
  order?: number;
  xs?: number | ColSpanConfig;
  sm?: number | ColSpanConfig;
  md?: number | ColSpanConfig;
  lg?: number | ColSpanConfig;
  xl?: number | ColSpanConfig;
  xxl?: number | ColSpanConfig;
}

interface ColSpanConfig {
  span?: number;
  offset?: number;
  push?: number;
  pull?: number;
  order?: number;
}

type Breakpoint = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl';
```

**功能要求**:
- 24栅格系统
- 响应式断点支持 (xs, sm, md, lg, xl, xxl)
- 间距设置
- 水平和垂直对齐
- 栅格偏移、排序

**样式接口点**:
```
.chips-row                    - Row 容器
.chips-row--justify-start     - 水平起始对齐
.chips-row--justify-center    - 水平居中
.chips-row--justify-end       - 水平结束对齐
.chips-row--justify-space-between
.chips-row--justify-space-around
.chips-row--align-top         - 垂直顶部对齐
.chips-row--align-middle      - 垂直居中
.chips-row--align-bottom      - 垂直底部对齐
.chips-row--no-wrap           - 不换行

.chips-col                    - Col 容器
.chips-col--1                 - 1/24
.chips-col--2                 - 2/24
... (1-24)
.chips-col--offset-1          - 偏移 1
... (1-24)
.chips-col--xs-1              - xs 响应式
.chips-col--sm-1              - sm 响应式
... (各断点)
```

**验收标准**:
- [ ] Row 组件实现完成
- [ ] Col 组件实现完成
- [ ] 响应式断点正常工作
- [ ] 间距计算正确
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.2: 实现 Flex 弹性布局组件

**描述**: 实现简化的 Flexbox 布局容器

**Props接口**:
```typescript
interface FlexProps {
  direction?: 'row' | 'row-reverse' | 'column' | 'column-reverse';
  justify?: 'start' | 'end' | 'center' | 'space-between' | 'space-around' | 'space-evenly';
  align?: 'start' | 'end' | 'center' | 'baseline' | 'stretch';
  wrap?: 'nowrap' | 'wrap' | 'wrap-reverse';
  gap?: number | [number, number];
  inline?: boolean;
}
```

**功能要求**:
- Flexbox 容器
- 主轴和交叉轴对齐
- 方向控制
- 换行控制
- 间距设置

**样式接口点**:
```
.chips-flex                   - Flex 容器
.chips-flex--inline           - 内联 Flex
.chips-flex--direction-row    - 行方向
.chips-flex--direction-column - 列方向
.chips-flex--justify-start    - 主轴起始
.chips-flex--justify-center   - 主轴居中
.chips-flex--align-start      - 交叉轴起始
.chips-flex--align-center     - 交叉轴居中
.chips-flex--wrap             - 换行
.chips-flex--nowrap           - 不换行
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 所有 Flex 属性支持
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.3: 实现 Container 容器组件

**描述**: 实现页面容器组件

**Props接口**:
```typescript
interface ContainerProps {
  maxWidth?: number | 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'full' | 'none';
  centered?: boolean;
  fluid?: boolean;
}
```

**功能要求**:
- 最大宽度限制
- 居中对齐
- 流式布局

**样式接口点**:
```
.chips-container              - 容器
.chips-container--centered    - 居中
.chips-container--fluid       - 流式
.chips-container--xs          - xs 宽度
.chips-container--sm          - sm 宽度
.chips-container--md          - md 宽度
.chips-container--lg          - lg 宽度
.chips-container--xl          - xl 宽度
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 宽度限制正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.4: 实现 Layout 布局框架组件

**描述**: 实现页面整体布局框架

**组件列表**:
- Layout - 布局容器
- Header - 顶部布局
- Sider - 侧边栏布局
- Content - 内容布局
- Footer - 底部布局

**Props接口**:
```typescript
// Layout
interface LayoutProps {
  hasSider?: boolean;
}

// Header
interface HeaderProps {
  height?: number | string;
}

// Sider
interface SiderProps {
  width?: number | string;
  collapsedWidth?: number | string;
  collapsed?: boolean;
  collapsible?: boolean;
  reverseArrow?: boolean;
  trigger?: VNode | null;
  breakpoint?: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl';
}

interface SiderEmits {
  'update:collapsed': [collapsed: boolean];
  collapse: [collapsed: boolean, type: 'clickTrigger' | 'responsive'];
  breakpoint: [broken: boolean];
}

// Content
interface ContentProps {}

// Footer
interface FooterProps {}
```

**功能要求**:
- 支持各种页面布局组合
- 侧边栏折叠
- 响应式折叠
- 自定义触发器

**样式接口点**:
```
.chips-layout                 - 布局容器
.chips-layout--has-sider      - 有侧边栏

.chips-layout-header          - 顶部
.chips-layout-sider           - 侧边栏
.chips-layout-sider__trigger  - 折叠触发器
.chips-layout-sider__children - 侧边栏内容
.chips-layout-sider--collapsed - 已折叠
.chips-layout-sider--collapsible - 可折叠

.chips-layout-content         - 内容区

.chips-layout-footer          - 底部
```

**验收标准**:
- [ ] 所有布局组件实现完成
- [ ] 侧边栏折叠功能正常
- [ ] 响应式折叠正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.5: 实现 Space 间距组件

**描述**: 实现元素间距控制组件

**Props接口**:
```typescript
interface SpaceProps {
  size?: 'small' | 'medium' | 'large' | number | [number, number];
  direction?: 'horizontal' | 'vertical';
  align?: 'start' | 'end' | 'center' | 'baseline';
  wrap?: boolean;
  split?: VNode;
}
```

**功能要求**:
- 控制子元素间距
- 水平和垂直方向
- 自动换行
- 分隔符支持

**样式接口点**:
```
.chips-space                  - 间距容器
.chips-space__item            - 间距项
.chips-space__split           - 分隔符
.chips-space--horizontal      - 水平方向
.chips-space--vertical        - 垂直方向
.chips-space--align-start
.chips-space--align-center
.chips-space--align-end
.chips-space--wrap            - 换行
.chips-space--small           - 小间距
.chips-space--medium          - 中间距
.chips-space--large           - 大间距
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 间距控制正常
- [ ] 换行功能正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.6: 实现 Card 卡片容器组件

**描述**: 实现通用卡片容器组件

**Props接口**:
```typescript
interface CardProps {
  title?: string;
  bordered?: boolean;
  hoverable?: boolean;
  loading?: boolean;
  size?: 'default' | 'small';
  headStyle?: CSSProperties;
  bodyStyle?: CSSProperties;
}

interface CardSlots {
  default?: () => VNode;
  title?: () => VNode;
  extra?: () => VNode;
  cover?: () => VNode;
  actions?: () => VNode;
}
```

**功能要求**:
- 标题和操作区
- 封面图支持
- 操作栏支持
- 加载状态
- 悬停效果

**样式接口点**:
```
.chips-card                   - 卡片容器
.chips-card__head             - 卡片头部
.chips-card__title            - 卡片标题
.chips-card__extra            - 额外操作区
.chips-card__cover            - 封面区域
.chips-card__body             - 卡片主体
.chips-card__actions          - 操作栏
.chips-card--bordered         - 有边框
.chips-card--hoverable        - 可悬停
.chips-card--loading          - 加载中
.chips-card--small            - 小尺寸
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 所有插槽正常
- [ ] 加载状态正常
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.7: 实现 Form 表单组件

**描述**: 实现表单容器和管理组件

**Props接口**:
```typescript
interface FormProps {
  model?: Record<string, unknown>;
  rules?: FormRules;
  layout?: 'horizontal' | 'vertical' | 'inline';
  labelWidth?: number | string;
  labelAlign?: 'left' | 'right';
  labelCol?: ColProps;
  wrapperCol?: ColProps;
  disabled?: boolean;
  scrollToError?: boolean;
  validateOnRuleChange?: boolean;
}

interface FormEmits {
  submit: [event: Event];
  validate: [field: string, valid: boolean, errors: string[]];
  finish: [values: Record<string, unknown>];
  finishFailed: [errors: ValidateError[]];
}

interface FormMethods {
  validate: (fields?: string[]) => Promise<void>;
  validateField: (field: string) => Promise<void>;
  resetFields: (fields?: string[]) => void;
  clearValidate: (fields?: string[]) => void;
  getFieldValue: (field: string) => unknown;
  setFieldValue: (field: string, value: unknown) => void;
  getFieldsValue: () => Record<string, unknown>;
  setFieldsValue: (values: Record<string, unknown>) => void;
  scrollToField: (field: string) => void;
}

type FormRules = Record<string, FormRule | FormRule[]>;

interface FormRule {
  required?: boolean;
  message?: string;
  type?: 'string' | 'number' | 'boolean' | 'array' | 'object' | 'email' | 'url';
  min?: number;
  max?: number;
  len?: number;
  pattern?: RegExp;
  validator?: (rule: FormRule, value: unknown) => Promise<void> | void;
  trigger?: 'blur' | 'change' | ('blur' | 'change')[];
}
```

**功能要求**:
- 表单数据管理
- 表单验证
- 多种布局模式
- 滚动到错误
- 表单方法暴露

**样式接口点**:
```
.chips-form                   - 表单容器
.chips-form--horizontal       - 水平布局
.chips-form--vertical         - 垂直布局
.chips-form--inline           - 行内布局
.chips-form--disabled         - 禁用状态
```

**验收标准**:
- [ ] 表单容器实现完成
- [ ] 验证功能正常
- [ ] 表单方法可用
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.8: 实现 FormItem 表单项组件

**描述**: 实现表单项包装组件

**Props接口**:
```typescript
interface FormItemProps {
  label?: string;
  name?: string | string[];
  rules?: FormRule | FormRule[];
  required?: boolean;
  labelWidth?: number | string;
  labelCol?: ColProps;
  wrapperCol?: ColProps;
  help?: string;
  extra?: string;
  validateStatus?: 'success' | 'warning' | 'error' | 'validating';
  hasFeedback?: boolean;
  tooltip?: string;
  colon?: boolean;
}

interface FormItemSlots {
  default?: () => VNode;
  label?: () => VNode;
  help?: () => VNode;
  extra?: () => VNode;
}
```

**功能要求**:
- 标签显示
- 验证状态显示
- 帮助信息
- 必填标记
- 验证反馈图标

**样式接口点**:
```
.chips-form-item              - 表单项容器
.chips-form-item__label       - 标签
.chips-form-item__required    - 必填标记
.chips-form-item__control     - 控件区域
.chips-form-item__content     - 内容
.chips-form-item__help        - 帮助信息
.chips-form-item__extra       - 额外信息
.chips-form-item__feedback    - 验证反馈图标
.chips-form-item--error       - 错误状态
.chips-form-item--warning     - 警告状态
.chips-form-item--success     - 成功状态
.chips-form-item--validating  - 验证中
.chips-form-item--required    - 必填项
.chips-form-item--has-feedback- 有反馈图标
```

**验收标准**:
- [ ] 组件实现完成
- [ ] 与 Form 联动正常
- [ ] 验证状态显示正确
- [ ] 单元测试覆盖率 ≥80%

---

### 任务4.9: 实现组件导出配置

**描述**: 配置布局和表单组件的统一导出

**详细步骤**:
1. 创建 `src/components/layout/index.ts`
2. 创建 `src/components/form/index.ts`
3. 更新 `src/components/index.ts`
4. 更新 `src/index.ts`

**验收标准**:
- [ ] 所有组件正确导出
- [ ] 类型正确导出

---

### 任务4.10: 阶段验证和提交

**描述**: 完成布局和表单组件的验证和提交

**验收标准**:
- [ ] 所有测试通过
- [ ] 布局组件协作正常
- [ ] 表单验证功能正常
- [ ] 代码提交完成
- [ ] 阶段总结编写完成

---

## 阶段验收标准

- [ ] Grid (Row/Col) 组件完成
- [ ] Flex 组件完成
- [ ] Container 组件完成
- [ ] Layout 系列组件完成
- [ ] Space 组件完成
- [ ] Card 组件完成
- [ ] Form 组件完成
- [ ] FormItem 组件完成
- [ ] 所有组件无样式代码
- [ ] 单元测试覆盖率 ≥80%

---

**更新时间**: 2026-02-01
